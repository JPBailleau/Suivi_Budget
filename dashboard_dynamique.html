
    <!DOCTYPE html>
    <html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Dashboard Budg√©taire Strat√©gique</title>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <!-- Google Fonts pour un look premium -->
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
        <style>
            :root {
                --primary: #2c3e50;
                --accent: #3498db;
                --success: #27ae60;
                --danger: #e74c3c;
                --exp: #9b59b6;
                --prod: #2ecc71;
                --bg: #f8f9fa;
                --card-bg: #ffffff;
                --text: #2c3e50;
                --text-light: #7f8c8d;
            }
            
            body { font-family: 'Inter', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 0; min-height: 100vh; }
            
            /* --- LAYOUTS --- */
            .view { display: none; padding: 2rem; max-width: 1200px; margin: 0 auto; animation: fadein 0.3s; }
            .view.active { display: block; }
            
            @keyframes fadein { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

            /* --- HOME VIEW (Year Selection) --- */
            .home-container { text-align: center; margin-top: 10vh; }
            .home-title { font-size: 2.5rem; font-weight: 700; margin-bottom: 3rem; color: var(--primary); }
            .year-grid { display: flex; justify-content: center; gap: 2rem; flex-wrap: wrap; }
            .year-btn { 
                background: var(--card-bg); border: 2px solid var(--accent); color: var(--accent); 
                font-size: 2rem; padding: 2rem 4rem; border-radius: 12px; cursor: pointer; 
                transition: all 0.2s ease; box-shadow: 0 4px 6px rgba(0,0,0,0.05); font-weight: 600;
            }
            .year-btn:hover { background: var(--accent); color: white; transform: translateY(-5px); box-shadow: 0 10px 15px rgba(52, 152, 219, 0.3); }

            /* --- DASHBOARD VIEW --- */
            .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
            .back-btn { 
                background: none; border: none; color: var(--text-light); font-weight: 600; cursor: pointer; 
                display: flex; align-items: center; gap: 0.5rem; font-size: 1rem; padding: 0.5rem 1rem; border-radius: 6px;
            }
            .back-btn:hover { background: rgba(0,0,0,0.05); color: var(--primary); }
            
            .controls { display: flex; gap: 1rem; align-items: center; }
            select { 
                padding: 0.8rem 1.5rem; border-radius: 8px; border: 1px solid #ddd; 
                font-size: 1rem; font-family: inherit; cursor: pointer; background-color: white; outline: none; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            }

            .kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
            .kpi-card { background: var(--card-bg); padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); border-left: 5px solid transparent; }
            .kpi-title { font-size: 0.85rem; text-transform: uppercase; color: var(--text-light); letter-spacing: 0.5px; margin-bottom: 0.5rem; }
            .kpi-value { font-size: 1.8rem; font-weight: 700; color: var(--primary); }
            .kpi-sub { font-size: 0.9rem; margin-top: 0.5rem; }
            
            .row { display: grid; grid-template-columns: 1fr 2fr; gap: 2rem; margin-bottom: 2rem; }
            @media (max-width: 900px) { .row { grid-template-columns: 1fr; } }
            
            .panel { background: var(--card-bg); padding: 2rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); }
            .panel h2 { margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 1rem; font-size: 1.2rem; }
            
            .metric-row { display: flex; justify-content: space-between; padding: 1rem 0; border-bottom: 1px solid #f0f0f0; }
            .metric-row:last-child { border-bottom: none; }
            .metric-val { font-family: 'Consolas', monospace; font-weight: 600; }
            
            .chart-wrapper { position: relative; height: 400px; width: 100%; }
            
            .positive { color: var(--success); }
            .negative { color: var(--danger); }
        </style>
    </head>
    <body>
        

        <!-- VIEW 1: HOME -->
        <div id="view-home" class="view active">
            <div class="home-container">
                <div class="home-title">S√©lectionnez une Ann√©e</div>
                <div id="year-buttons" class="year-grid">
                    <!-- G√©n√©r√© par JS -->
                </div>
                
                <!-- BOUTON COMPARAISON -->
                <div style="margin-top: 3rem;">
                    <button onclick="goToComparison()" class="year-btn" style="font-size: 1.2rem; padding: 1rem 2rem; border-color: var(--exp); color: var(--exp);">
                        üìä Comparer les Ann√©es
                    </button>
                </div>

                <div style="margin-top: 3rem; color: var(--text-light); font-size: 0.9rem;">
                    Donn√©es mises √† jour le : <strong>22/12/2025</strong>
                    <span style="margin: 0 10px;">‚Ä¢</span>
                    Jours f√©ri√©s charg√©s : <strong>39</strong>
                    <span style="margin: 0 10px;">‚Ä¢</span>
                    Lignes Budget charg√©es : <strong>25</strong>
                    <span style="margin: 0 10px;">‚Ä¢</span>
                    Lignes R√©sultats charg√©es : <strong>356</strong>
                </div>
            </div>
        </div>

        <!-- VIEW 3: COMPARISON -->
        <div id="view-comparison" class="view">
            <div class="top-bar">
                <button class="back-btn" onclick="goHome()">‚Üê Retour √† l'accueil</button>
                <div class="controls">
                    <h1 style="margin:0; font-size:1.5rem; color: var(--exp);">Comparaison Ann√©es</h1>
                </div>
            </div>
            
            <div class="panel">
                <div style="margin-bottom: 1rem;">
                    <strong>Afficher les ann√©es :</strong>
                    <div id="comp-toggles" style="display: flex; gap: 1rem; flex-wrap: wrap; margin-top: 0.5rem;">
                        <!-- Checkboxes g√©n√©r√©es par JS -->
                    </div>
                </div>
                <div class="chart-wrapper" style="height: 500px;">
                    <canvas id="compChart"></canvas>
                </div>
            </div>
        </div>

        <!-- VIEW 2: DASHBOARD -->
        <div id="view-dashboard" class="view">
            <div class="top-bar">
                <button class="back-btn" onclick="goHome()">‚Üê Choisir une autre ann√©e</button>
                <div class="controls">
                    <h1 id="year-display" style="margin:0; font-size:1.5rem; margin-right:1rem;">2025</h1>
                    <select id="month-selector" onchange="selectMonth(this.value)">
                        <!-- G√©n√©r√© par JS -->
                    </select>
                </div>
            </div>

            <div class="kpi-grid">
                <div class="kpi-card" style="border-color: var(--accent);">
                    <div class="kpi-title">Jours Ouvr√©s</div>
                    <div class="kpi-value" id="kpi-days">-</div>
                </div>
                <div class="kpi-card" style="border-color: var(--primary);">
                    <div class="kpi-title">Objectif Budget</div>
                    <div class="kpi-value" id="kpi-budget">- ‚Ç¨</div>
                </div>
                <div class="kpi-card" id="kpi-card-perf">
                    <div class="kpi-title">R√©alisation</div>
                    <div class="kpi-value" id="kpi-percent">-%</div>
                </div>
            </div>

            <div class="row">
                <!-- COL GAUCHE: CHIFFRES -->
                <div class="panel">
                    <h2>Performance Mensuelle</h2>
                    <div class="metric-row">
                        <span>CA R√©alis√©</span>
                        <span class="metric-val" id="val-ca">-</span>
                    </div>
                    <div class="metric-row">
                        <span>√âcart vs Budget</span>
                        <span class="metric-val" id="val-diff">-</span>
                    </div>
                    
                    <h2 style="margin-top:2rem;">Production & Commandes</h2>
                    <div class="metric-row">
                        <span>Prise de Commande</span>
                        <span class="metric-val" id="val-cmd">-</span>
                    </div>
                    <div class="metric-row">
                        <span>Montant Produit</span>
                        <span class="metric-val" id="val-prod">-</span>
                    </div>
                </div>

                <!-- COL DROITE: GRAPHIQUE -->
                <div class="panel">
                    <h2>√âvolution Cumul√©e</h2>
                    <div class="chart-wrapper">
                        <canvas id="mainChart"></canvas>
                    </div>
                </div>
            </div>
            
        </div>

        <script>
            // DONNEES INJECTEES PAR PYTHON
            const DB_DATA = {"2025": {"1": {"budget": 1728162.0, "realise": 1686613.5500000003, "commandes": 1104942.0912509002, "produit": 1707155.2700000003, "jours_ouvres": 22, "chart_labels": ["01/01", "02/01", "03/01", "04/01", "05/01", "06/01", "07/01", "08/01", "09/01", "10/01", "11/01", "12/01", "13/01", "14/01", "15/01", "16/01", "17/01", "18/01", "19/01", "20/01", "21/01", "22/01", "23/01", "24/01", "25/01", "26/01", "27/01", "28/01", "29/01", "30/01", "31/01"], "chart_ca": [0.0, 81242.78, 160323.38, 160323.38, 160323.38, 256248.71000000002, 391468.12, 464954.69, 508395.69, 665915.38, 665915.38, 665915.38, 707161.27, 809086.0900000001, 881572.9100000001, 919419.2700000001, 963403.1500000001, 963403.1500000001, 963403.1500000001, 1030867.5900000001, 1125852.6, 1249303.81, 1318338.6800000002, 1342530.35, 1342530.35, 1342530.35, 1427628.8900000001, 1475076.4900000002, 1562071.5200000003, 1633442.7700000003, 1686613.5500000003], "chart_cmd": [0.0, 12774.223, 32071.589500000002, 32071.589500000002, 32071.589500000002, 68922.0271, 103387.45585, 213291.99945, 253292.3163825, 358539.6119128, 358539.6119128, 358539.6119128, 411239.9474128, 532951.6914128, 579470.4134128, 622323.1124128, 639297.1604127999, 639297.1604127999, 639297.1604127999, 664794.7977527999, 735636.9677528, 767497.1286649, 782986.4886649, 817106.8575108999, 817106.8575108999, 817106.8575108999, 848042.4075108999, 991980.4705108999, 1051874.4452509, 1096281.6912509, 1104942.0912509], "chart_prod": [0.0, 9965.75, 44401.02, 44401.02, 44401.02, 78009.29, 202512.58, 412898.98, 476303.54, 638737.0, 638737.0, 638737.0, 690245.15, 775309.41, 842977.17, 939975.0900000001, 1032589.8600000001, 1032589.8600000001, 1032589.8600000001, 1106237.12, 1162703.3, 1271671.6600000001, 1353915.9700000002, 1396353.62, 1396353.62, 1396353.62, 1470667.32, 1563228.06, 1607464.9300000002, 1646671.5300000003, 1707155.2700000003], "chart_budget_trend": [0.0, 78552.81818181818, 157105.63636363635, 157105.63636363635, 157105.63636363635, 235658.45454545453, 314211.2727272727, 392764.0909090909, 471316.90909090906, 549869.7272727273, 549869.7272727273, 549869.7272727273, 628422.5454545454, 706975.3636363635, 785528.1818181816, 864080.9999999998, 942633.8181818179, 942633.8181818179, 942633.8181818179, 1021186.636363636, 1099739.4545454541, 1178292.2727272722, 1256845.0909090904, 1335397.9090909085, 1335397.9090909085, 1335397.9090909085, 1413950.7272727266, 1492503.5454545447, 1571056.3636363628, 1649609.181818181, 1728161.999999999]}, "2": {"budget": 1531000.0, "realise": 1319134.3199999996, "commandes": 1605240.5986345, "produit": 1275235.39, "jours_ouvres": 20, "chart_labels": ["01/02", "02/02", "03/02", "04/02", "05/02", "06/02", "07/02", "08/02", "09/02", "10/02", "11/02", "12/02", "13/02", "14/02", "15/02", "16/02", "17/02", "18/02", "19/02", "20/02", "21/02", "22/02", "23/02", "24/02", "25/02", "26/02", "27/02", "28/02"], "chart_ca": [0.0, 0.0, 44248.25, 84234.88, 146917.88, 228384.40000000002, 292422.55000000005, 292422.55000000005, 292422.55000000005, 338088.29000000004, 416402.76, 484886.02, 531206.97, 563534.46, 563534.46, 563534.46, 660023.73, 776922.54, 817123.38, 888642.5700000001, 1014284.75, 1014284.75, 1014284.75, 1034946.42, 1081996.3, 1204121.47, 1258061.42, 1319134.3199999998], "chart_cmd": [0.0, 0.0, 22372.553, 175135.97519169998, 213558.19516859998, 390024.34172609996, 447568.94651349995, 447568.94651349995, 447568.94651349995, 533461.7467535, 568934.3212535, 648376.0770935, 663871.1783707, 687242.0983707, 687242.0983707, 687242.0983707, 714999.6617124, 829348.2699524, 1127148.1211524, 1211667.5821525, 1263929.9198345, 1263929.9198345, 1263929.9198345, 1312505.1802345, 1364043.4666345, 1471230.3586345, 1559833.3786345, 1605240.5986345], "chart_prod": [0.0, 0.0, 39001.11, 90954.09, 172872.34999999998, 210756.90999999997, 270885.11, 270885.11, 270885.11, 321548.02, 377518.83, 467089.27, 498879.64, 560907.48, 560907.48, 560907.48, 614682.4299999999, 751008.1499999999, 797892.8999999999, 840894.7699999999, 914584.1099999999, 914584.1099999999, 914584.1099999999, 977045.0599999998, 1115447.39, 1165058.7799999998, 1219443.1699999997, 1275235.3899999997], "chart_budget_trend": [0.0, 0.0, 76550.0, 153100.0, 229650.0, 306200.0, 382750.0, 382750.0, 382750.0, 459300.0, 535850.0, 612400.0, 688950.0, 765500.0, 765500.0, 765500.0, 842050.0, 918600.0, 995150.0, 1071700.0, 1148250.0, 1148250.0, 1148250.0, 1224800.0, 1301350.0, 1377900.0, 1454450.0, 1531000.0]}, "3": {"budget": 1690064.0, "realise": 1516096.7900000003, "commandes": 1450300.0392618, "produit": 1616553.31, "jours_ouvres": 21, "chart_labels": ["01/03", "02/03", "03/03", "04/03", "05/03", "06/03", "07/03", "08/03", "09/03", "10/03", "11/03", "12/03", "13/03", "14/03", "15/03", "16/03", "17/03", "18/03", "19/03", "20/03", "21/03", "22/03", "23/03", "24/03", "25/03", "26/03", "27/03", "28/03", "29/03", "30/03", "31/03"], "chart_ca": [0.0, 0.0, 60530.59, 117086.70999999999, 152085.63999999998, 261436.75, 277467.8, 277467.8, 277467.8, 336436.01, 397054.36, 444591.86, 508558.26, 539388.1, 539388.1, 539388.1, 603759.64, 712136.81, 832192.6100000001, 874307.2800000001, 1052367.9300000002, 1052367.9300000002, 1052367.9300000002, 1090135.0000000002, 1120930.4800000002, 1179225.3100000003, 1306690.3900000004, 1379468.9500000004, 1379468.9500000004, 1379468.9500000004, 1516096.7900000005], "chart_cmd": [0.0, 0.0, 97393.4129556, 198026.9156515, 274733.1156515, 368097.6601515, 417009.1001515, 417009.1001515, 417009.1001515, 463323.144654, 546814.367494, 591108.0667096, 707744.4708873001, 736292.7402290001, 736292.7402290001, 736292.7402290001, 856891.6634290001, 890344.2854080001, 1032500.2354080002, 1136278.2985417002, 1236121.4195417003, 1236121.4195417003, 1236121.4195417003, 1300667.2295417003, 1337053.0979417004, 1385560.4509417005, 1413572.0770086006, 1416500.0770086006, 1416500.0770086006, 1416500.0770086006, 1450300.0392618005], "chart_prod": [0.0, 0.0, 31215.4, 158443.0, 224096.24, 292852.32, 388792.83, 388792.83, 388792.83, 434720.98000000004, 484114.07000000007, 537706.54, 596764.1900000001, 711516.7400000001, 711516.7400000001, 711516.7400000001, 784850.5400000002, 848629.8000000002, 988763.7400000002, 1067322.7800000003, 1168732.3800000004, 1168732.3800000004, 1168732.3800000004, 1221467.5400000003, 1281804.3300000003, 1368682.5300000003, 1446800.0700000003, 1488755.6100000003, 1488755.6100000003, 1488755.6100000003, 1616553.3100000003], "chart_budget_trend": [0.0, 0.0, 80479.23809523809, 160958.47619047618, 241437.71428571426, 321916.95238095237, 402396.1904761905, 402396.1904761905, 402396.1904761905, 482875.4285714286, 563354.6666666666, 643833.9047619047, 724313.1428571428, 804792.380952381, 804792.380952381, 804792.380952381, 885271.619047619, 965750.8571428572, 1046230.0952380953, 1126709.3333333333, 1207188.5714285714, 1207188.5714285714, 1207188.5714285714, 1287667.8095238095, 1368147.0476190476, 1448626.2857142857, 1529105.5238095238, 1609584.761904762, 1609584.761904762, 1609584.761904762, 1690064.0]}, "4": {"budget": 1770064.0, "realise": 1427289.0799999998, "commandes": 2122136.487931, "produit": 1448973.35, "jours_ouvres": 21, "chart_labels": ["01/04", "02/04", "03/04", "04/04", "05/04", "06/04", "07/04", "08/04", "09/04", "10/04", "11/04", "12/04", "13/04", "14/04", "15/04", "16/04", "17/04", "18/04", "19/04", "20/04", "21/04", "22/04", "23/04", "24/04", "25/04", "26/04", "27/04", "28/04", "29/04", "30/04"], "chart_ca": [30478.25, 123066.2, 154381.97, 251836.55, 251836.55, 251836.55, 303594.91, 362112.49, 390158.27999999997, 448836.88999999996, 511670.93999999994, 511670.93999999994, 511670.93999999994, 555658.8799999999, 660786.7, 746869.62, 787631.48, 824422.38, 824422.38, 824422.38, 824422.38, 856454.04, 936444.28, 1036794.89, 1087832.44, 1087832.44, 1087832.44, 1223509.1199999999, 1273059.9, 1427289.0799999998], "chart_cmd": [45767.8, 122169.25175, 152247.5929969, 168911.3429969, 168911.3429969, 168911.3429969, 358462.4679927, 561781.4627542, 645663.6722098, 702872.6372098, 752670.0384115999, 752670.0384115999, 752670.0384115999, 805616.9504116, 1158685.0330116, 1679023.766748, 1729331.86802, 1744268.66802, 1744268.66802, 1744268.66802, 1744268.66802, 1882660.42802, 1940186.1427179, 1959527.5327179, 1993956.7219709998, 1993956.7219709998, 1993956.7219709998, 2035697.5410481999, 2097337.367931, 2122136.487931], "chart_prod": [48589.09, 102404.98999999999, 165986.36, 249678.34999999998, 249678.34999999998, 249678.34999999998, 291614.95999999996, 345220.41, 377550.75999999995, 459554.85, 502702.6, 502702.6, 502702.6, 530894.69, 674759.6699999999, 727448.83, 801784.0499999999, 863367.3799999999, 863367.3799999999, 863367.3799999999, 863367.3799999999, 905850.6299999999, 1037587.44, 1132348.8499999999, 1236598.6199999999, 1236598.6199999999, 1236598.6199999999, 1275853.23, 1393171.39, 1448973.3499999999], "chart_budget_trend": [84288.76190476191, 168577.52380952382, 252866.28571428574, 337155.04761904763, 337155.04761904763, 337155.04761904763, 421443.8095238095, 505732.5714285714, 590021.3333333334, 674310.0952380953, 758598.8571428572, 758598.8571428572, 758598.8571428572, 842887.619047619, 927176.380952381, 1011465.1428571428, 1095753.9047619049, 1180042.6666666667, 1180042.6666666667, 1180042.6666666667, 1180042.6666666667, 1264331.4285714286, 1348620.1904761905, 1432908.9523809524, 1517197.7142857143, 1517197.7142857143, 1517197.7142857143, 1601486.4761904762, 1685775.238095238, 1770064.0]}, "5": {"budget": 1561966.0, "realise": 1090804.0299999998, "commandes": 1592972.1007440998, "produit": 1210217.86, "jours_ouvres": 19, "chart_labels": ["01/05", "02/05", "03/05", "04/05", "05/05", "06/05", "07/05", "08/05", "09/05", "10/05", "11/05", "12/05", "13/05", "14/05", "15/05", "16/05", "17/05", "18/05", "19/05", "20/05", "21/05", "22/05", "23/05", "24/05", "25/05", "26/05", "27/05", "28/05", "29/05", "30/05", "31/05"], "chart_ca": [0.0, 0.0, 0.0, 0.0, 104186.99, 146908.11000000002, 173323.77000000002, 173323.77000000002, 213242.10000000003, 213242.10000000003, 213242.10000000003, 276248.61000000004, 335123.31000000006, 379647.12000000005, 435061.28, 473078.18000000005, 473078.18000000005, 473078.18000000005, 539369.91, 596049.76, 684865.28, 784286.62, 792772.12, 792772.12, 792772.12, 905682.97, 949984.38, 1014751.37, 1014751.37, 1090804.03, 1090804.03], "chart_cmd": [0.0, 0.0, 0.0, 0.0, 67535.1685834, 87013.63080439999, 173660.33233349997, 173660.33233349997, 423037.7302835, 423037.7302835, 423037.7302835, 478500.2911161, 567043.8406391, 593848.9106390999, 889811.1884790999, 1037332.8144790998, 1037332.8144790998, 1037332.8144790998, 1158551.2240790997, 1199310.5196514998, 1286954.3544114998, 1314696.6039645998, 1382271.1550187997, 1382271.1550187997, 1382271.1550187997, 1409855.1900187996, 1513078.6474940996, 1530314.9747440997, 1530314.9747440997, 1592972.1007440996, 1592972.1007440996], "chart_prod": [0.0, 14290.46, 14290.46, 14290.46, 67266.31, 100165.19, 160452.72, 160452.72, 186314.03, 186314.03, 186314.03, 238078.88, 336587.75, 391872.18, 471116.65, 528825.4400000001, 528825.4400000001, 528825.4400000001, 627969.3400000001, 692709.8600000001, 813047.3200000001, 870676.6000000001, 1019163.6400000001, 1019163.6400000001, 1019163.6400000001, 1066508.34, 1147095.53, 1171245.4000000001, 1171245.4000000001, 1210217.86, 1210217.86], "chart_budget_trend": [0.0, 82208.73684210527, 82208.73684210527, 82208.73684210527, 164417.47368421053, 246626.2105263158, 328834.94736842107, 328834.94736842107, 411043.68421052635, 411043.68421052635, 411043.68421052635, 493252.42105263163, 575461.1578947369, 657669.8947368421, 739878.6315789474, 822087.3684210527, 822087.3684210527, 822087.3684210527, 904296.105263158, 986504.8421052633, 1068713.5789473685, 1150922.3157894737, 1233131.0526315789, 1233131.0526315789, 1233131.0526315789, 1315339.789473684, 1397548.5263157892, 1479757.2631578944, 1479757.2631578944, 1561965.9999999995, 1561965.9999999995]}, "6": {"budget": 1720064.0, "realise": 1519824.43, "commandes": 1562204.6459970002, "produit": 1574081.2, "jours_ouvres": 19, "chart_labels": ["01/06", "02/06", "03/06", "04/06", "05/06", "06/06", "07/06", "08/06", "09/06", "10/06", "11/06", "12/06", "13/06", "14/06", "15/06", "16/06", "17/06", "18/06", "19/06", "20/06", "21/06", "22/06", "23/06", "24/06", "25/06", "26/06", "27/06", "28/06", "29/06", "30/06"], "chart_ca": [0.0, 49153.99, 212809.99, 258932.75, 323283.54, 417324.67, 417324.67, 417324.67, 417324.67, 507356.63, 545327.11, 615615.46, 684553.35, 684553.35, 684553.35, 744490.45, 872341.22, 918411.9199999999, 1068537.68, 1131141.45, 1131141.45, 1131141.45, 1155872.13, 1193298.8499999999, 1316814.98, 1385698.46, 1519824.43, 1519824.43, 1519824.43, 1519824.43], "chart_cmd": [0.0, 71341.8469249, 130307.9996749, 147861.581068, 347636.549068, 496898.17489080003, 496898.17489080003, 496898.17489080003, 512780.9777708, 645070.3417122, 725884.2251865, 769056.5746865, 798288.3146465, 798288.3146465, 798288.3146465, 911145.0169465, 969379.2061465001, 974126.6061465001, 1073255.6431465, 1134001.4190879, 1134001.4190879, 1134001.4190879, 1170224.5689579002, 1243761.4887453, 1257006.6807453001, 1293650.7852453, 1301633.9832453001, 1301633.9832453001, 1301633.9832453001, 1562204.6459970002], "chart_prod": [0.0, 48074.41, 183034.71, 239695.09999999998, 316735.01999999996, 336143.42999999993, 336143.42999999993, 336143.42999999993, 382713.20999999996, 430122.50999999995, 474892.83999999997, 546223.8999999999, 619991.0199999999, 619991.0199999999, 619991.0199999999, 660722.0799999998, 796576.5599999998, 933384.7299999999, 986686.6199999999, 1027835.9299999999, 1027835.9299999999, 1027835.9299999999, 1051831.3499999999, 1102064.2899999998, 1251009.14, 1300278.5499999998, 1564374.4799999997, 1564374.4799999997, 1564374.4799999997, 1574081.1999999997], "chart_budget_trend": [0.0, 90529.68421052632, 181059.36842105264, 271589.052631579, 362118.7368421053, 452648.4210526316, 452648.4210526316, 452648.4210526316, 452648.4210526316, 543178.1052631579, 633707.7894736842, 724237.4736842104, 814767.1578947367, 814767.1578947367, 814767.1578947367, 905296.842105263, 995826.5263157893, 1086356.2105263157, 1176885.894736842, 1267415.5789473683, 1267415.5789473683, 1267415.5789473683, 1357945.2631578946, 1448474.947368421, 1539004.6315789472, 1629534.3157894735, 1720063.9999999998, 1720063.9999999998, 1720063.9999999998, 1720063.9999999998]}, "7": {"budget": 1818162.0, "realise": 2029316.75, "commandes": 1881431.8616995998, "produit": 1843568.0599999996, "jours_ouvres": 22, "chart_labels": ["01/07", "02/07", "03/07", "04/07", "05/07", "06/07", "07/07", "08/07", "09/07", "10/07", "11/07", "12/07", "13/07", "14/07", "15/07", "16/07", "17/07", "18/07", "19/07", "20/07", "21/07", "22/07", "23/07", "24/07", "25/07", "26/07", "27/07", "28/07", "29/07", "30/07", "31/07"], "chart_ca": [38935.5, 107959.36, 230565.5, 362303.17000000004, 362303.17000000004, 362303.17000000004, 397754.27, 451493.07, 619777.35, 908984.58, 1065486.8499999999, 1065486.8499999999, 1065486.8499999999, 1065486.8499999999, 1111483.5899999999, 1271760.65, 1309563.8599999999, 1386747.48, 1386747.48, 1386747.48, 1441486.04, 1492403.78, 1581003.11, 1699698.53, 1754700.32, 1754700.32, 1754700.32, 1813318.6400000001, 1875993.4800000002, 1965696.6900000002, 2029316.7500000002], "chart_cmd": [55975.80375, 110601.77753739999, 364579.7575374, 406207.9575374, 406207.9575374, 406207.9575374, 460507.08053740003, 560023.2704788, 584244.2194360001, 707141.3194360001, 709522.095436, 709522.095436, 709522.095436, 709522.095436, 909262.2308988001, 934914.0308988001, 966013.6580988001, 989452.7960988001, 989452.7960988001, 989452.7960988001, 1041093.9093788002, 1117783.5913788, 1173331.476429, 1201595.8704290001, 1236153.2137262002, 1236153.2137262002, 1236153.2137262002, 1379030.9837262002, 1610750.4870034002, 1787969.3670034003, 1881431.8616996002], "chart_prod": [52932.86, 217606.37, 308418.13, 381250.64, 393323.64, 393323.64, 446709.01, 572117.62, 628905.86, 732592.1799999999, 871462.1499999999, 871462.1499999999, 871462.1499999999, 871462.1499999999, 977877.3999999999, 1068274.38, 1134824.5099999998, 1170420.0599999998, 1170420.0599999998, 1170420.0599999998, 1230460.2599999998, 1295014.8599999999, 1336529.8199999998, 1508854.2799999998, 1529534.9099999997, 1540904.0699999996, 1540904.0699999996, 1586033.2799999996, 1693181.6599999997, 1800736.6699999997, 1843568.0599999996], "chart_budget_trend": [82643.72727272728, 165287.45454545456, 247931.18181818182, 330574.9090909091, 330574.9090909091, 330574.9090909091, 413218.6363636364, 495862.3636363637, 578506.0909090909, 661149.8181818182, 743793.5454545455, 743793.5454545455, 743793.5454545455, 743793.5454545455, 826437.2727272728, 909081.0000000001, 991724.7272727274, 1074368.4545454546, 1074368.4545454546, 1074368.4545454546, 1157012.1818181819, 1239655.9090909092, 1322299.6363636365, 1404943.3636363638, 1487587.090909091, 1487587.090909091, 1487587.090909091, 1570230.8181818184, 1652874.5454545456, 1735518.272727273, 1818162.0000000002]}, "8": {"budget": 530938.0, "realise": 667573.78, "commandes": 786555.2066940999, "produit": 666918.78, "jours_ouvres": 11, "chart_labels": ["01/08", "02/08", "03/08", "04/08", "05/08", "06/08", "07/08", "08/08", "09/08", "10/08", "11/08", "12/08", "13/08", "14/08", "15/08", "16/08", "17/08", "18/08", "19/08", "20/08", "21/08", "22/08", "23/08", "24/08", "25/08", "26/08", "27/08", "28/08", "29/08", "30/08", "31/08"], "chart_ca": [10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 10171.34, 98311.59999999999, 166044.4, 222167.09999999998, 254059.45999999996, 280202.42, 280202.42, 280202.42, 311637.38, 462313.03, 520858.99000000005, 594609.04, 667573.78, 667573.78, 667573.78], "chart_cmd": [58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 58314.9769477, 337070.0469521, 372806.8904636, 461126.9646964, 492059.0246964, 492059.0246964, 492059.0246964, 492059.0246964, 529652.9246964, 604881.7616963999, 631873.2026963999, 720568.2866963999, 786555.2066940999, 786555.2066940999, 786555.2066940999], "chart_prod": [40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 40371.92, 76726.11, 124438.0, 166621.94, 220105.33000000002, 240672.89, 240672.89, 240672.89, 396263.44, 451319.99, 541689.98, 595997.62, 623363.75, 666918.78, 666918.78], "chart_budget_trend": [48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 48267.09090909091, 96534.18181818182, 144801.27272727274, 193068.36363636365, 241335.45454545456, 289602.54545454547, 289602.54545454547, 289602.54545454547, 337869.63636363635, 386136.7272727273, 434403.81818181823, 482670.9090909092, 530938.0000000001, 530938.0000000001, 530938.0000000001]}, "9": {"budget": 1768162.0, "realise": 1648001.8699999996, "commandes": 1570057.2632188, "produit": 1675099.2000000002, "jours_ouvres": 22, "chart_labels": ["01/09", "02/09", "03/09", "04/09", "05/09", "06/09", "07/09", "08/09", "09/09", "10/09", "11/09", "12/09", "13/09", "14/09", "15/09", "16/09", "17/09", "18/09", "19/09", "20/09", "21/09", "22/09", "23/09", "24/09", "25/09", "26/09", "27/09", "28/09", "29/09", "30/09"], "chart_ca": [65670.3, 124442.48000000001, 159275.7, 355127.61, 416859.56, 416859.56, 416859.56, 500829.07, 590567.02, 634196.49, 725327.21, 789726.07, 789726.07, 789726.07, 887726.84, 943675.09, 1011000.35, 1102637.01, 1177436.66, 1177436.66, 1177436.66, 1239217.77, 1288300.97, 1338721.1199999999, 1400488.7699999998, 1466791.1399999997, 1466791.1399999997, 1466791.1399999997, 1601994.9199999997, 1648001.8699999996], "chart_cmd": [39526.04156, 142726.86356, 162257.3814, 264225.44667880004, 310876.18302050006, 310876.18302050006, 310876.18302050006, 371174.8458715001, 454136.97767150006, 607535.0495418, 647030.0214898001, 674648.0984898001, 674648.0984898001, 674648.0984898001, 716505.3307074001, 803622.9527074001, 827988.6827074001, 943895.0763274, 1011036.0603274, 1011036.0603274, 1011036.0603274, 1067290.7236720999, 1090029.499352, 1160942.7638887, 1313258.7532611, 1432857.5861611, 1432857.5861611, 1432857.5861611, 1506343.0129226001, 1570057.2632188], "chart_prod": [52477.66, 108337.45000000001, 281321.7, 364345.68, 470836.12, 494502.94, 494502.94, 550504.16, 557560.56, 660179.1000000001, 739708.4800000001, 818210.5200000001, 818210.5200000001, 818210.5200000001, 857873.0400000002, 931868.9500000002, 1016459.9500000002, 1083631.2000000002, 1124311.62, 1154326.25, 1154326.25, 1202396.61, 1231106.7000000002, 1281462.5200000003, 1346389.8500000003, 1426616.6800000004, 1426616.6800000004, 1426616.6800000004, 1513574.0300000005, 1675099.2000000004], "chart_budget_trend": [80371.0, 160742.0, 241113.0, 321484.0, 401855.0, 401855.0, 401855.0, 482226.0, 562597.0, 642968.0, 723339.0, 803710.0, 803710.0, 803710.0, 884081.0, 964452.0, 1044823.0, 1125194.0, 1205565.0, 1205565.0, 1205565.0, 1285936.0, 1366307.0, 1446678.0, 1527049.0, 1607420.0, 1607420.0, 1607420.0, 1687791.0, 1768162.0]}, "10": {"budget": 1718162.0, "realise": 1753841.9800000002, "commandes": 1897071.3680524998, "produit": 1794023.6300000004, "jours_ouvres": 23, "chart_labels": ["01/10", "02/10", "03/10", "04/10", "05/10", "06/10", "07/10", "08/10", "09/10", "10/10", "11/10", "12/10", "13/10", "14/10", "15/10", "16/10", "17/10", "18/10", "19/10", "20/10", "21/10", "22/10", "23/10", "24/10", "25/10", "26/10", "27/10", "28/10", "29/10", "30/10", "31/10"], "chart_ca": [73367.56, 188205.87, 264918.74, 264918.74, 264918.74, 332851.6, 386772.57999999996, 477499.30999999994, 546791.83, 611777.11, 611777.11, 611777.11, 717116.08, 804922.8899999999, 819350.4599999998, 850258.0399999998, 920136.9199999998, 920136.9199999998, 920136.9199999998, 953227.8899999998, 1047928.6699999998, 1123484.5599999998, 1212368.7899999998, 1294946.39, 1294946.39, 1294946.39, 1334273.47, 1420861.91, 1495166.4, 1588648.74, 1753841.98], "chart_cmd": [103917.76234, 198694.5107021, 348659.9645546, 348659.9645546, 348659.9645546, 395883.23309630004, 565714.1732622001, 656455.0164867, 700875.200311, 718381.0858298, 718381.0858298, 718381.0858298, 773161.2169454, 791366.0869454, 835735.3951654, 1042527.5125654, 1170396.1109654, 1170396.1109654, 1170396.1109654, 1219242.3540054, 1328503.7336742, 1478201.6701119, 1489816.0261118999, 1524269.5679529, 1524269.5679529, 1524269.5679529, 1711862.2627529, 1804060.4227528998, 1837711.4507528997, 1890541.5560524997, 1897071.3680524996], "chart_prod": [35900.75, 103278.18, 133329.81, 133329.81, 133329.81, 215371.5, 309993.07, 326168.01, 402256.03, 474649.48000000004, 474649.48000000004, 474649.48000000004, 512681.54000000004, 543312.38, 616306.24, 704810.24, 712879.58, 737416.6699999999, 737416.6699999999, 846435.0499999999, 916055.96, 1000673.01, 1097495.46, 1145668.04, 1218050.1600000001, 1218050.1600000001, 1278537.5300000003, 1418374.2800000003, 1425724.1100000003, 1681389.7600000002, 1794023.6300000004], "chart_budget_trend": [74702.69565217392, 149405.39130434784, 224108.08695652176, 224108.08695652176, 224108.08695652176, 298810.7826086957, 373513.4782608696, 448216.1739130436, 522918.8695652175, 597621.5652173915, 597621.5652173915, 597621.5652173915, 672324.2608695654, 747026.9565217394, 821729.6521739133, 896432.3478260873, 971135.0434782612, 971135.0434782612, 971135.0434782612, 1045837.7391304352, 1120540.434782609, 1195243.130434783, 1269945.8260869568, 1344648.5217391306, 1344648.5217391306, 1344648.5217391306, 1419351.2173913044, 1494053.9130434783, 1568756.608695652, 1643459.304347826, 1718161.9999999998]}, "11": {"budget": 1543868.0, "realise": 1488179.98, "commandes": 1663514.6162749003, "produit": 1486079.9500000002, "jours_ouvres": 19, "chart_labels": ["01/11", "02/11", "03/11", "04/11", "05/11", "06/11", "07/11", "08/11", "09/11", "10/11", "11/11", "12/11", "13/11", "14/11", "15/11", "16/11", "17/11", "18/11", "19/11", "20/11", "21/11", "22/11", "23/11", "24/11", "25/11", "26/11", "27/11", "28/11", "29/11", "30/11"], "chart_ca": [0.0, 0.0, 48896.3, 91413.16, 124232.72, 185774.99, 230441.22, 230441.22, 230441.22, 230441.22, 230441.22, 336238.51, 438397.06, 542504.38, 542504.38, 542504.38, 610363.15, 750579.8200000001, 850404.8500000001, 911244.55, 1050560.55, 1050560.55, 1050560.55, 1095913.1300000001, 1166325.57, 1270340.9000000001, 1367283.7000000002, 1488179.9800000002, 1488179.9800000002, 1488179.9800000002], "chart_cmd": [0.0, 0.0, 51232.08428, 116882.74506380002, 216441.2630638, 403268.7718638, 473685.1592071, 473685.1592071, 473685.1592071, 476155.5342071, 476155.5342071, 517410.1809686, 559895.5238886, 648841.2038886, 648841.2038886, 648841.2038886, 786530.4700829, 840798.6000829, 867284.8409706, 936463.2100731, 1079061.7283913, 1079061.7283913, 1079061.7283913, 1114457.0811649, 1145038.2369649, 1292081.9448749, 1637723.1274748999, 1663514.6162748998, 1663514.6162748998, 1663514.6162748998], "chart_prod": [0.0, 0.0, 59859.31, 135621.47999999998, 202684.02999999997, 251921.96999999997, 309436.0, 309436.0, 309436.0, 320968.03, 320968.03, 419118.34, 531851.22, 647222.32, 687938.9299999999, 687938.9299999999, 717480.8799999999, 824547.1099999999, 870193.0199999999, 905071.3399999999, 975078.8299999998, 975078.8299999998, 975078.8299999998, 1078327.0399999998, 1144654.3499999999, 1257474.5199999998, 1296638.14, 1486079.95, 1486079.95, 1486079.95], "chart_budget_trend": [0.0, 0.0, 81256.21052631579, 162512.42105263157, 243768.63157894736, 325024.84210526315, 406281.05263157893, 406281.05263157893, 406281.05263157893, 487537.2631578947, 487537.2631578947, 568793.4736842106, 650049.6842105263, 731305.894736842, 731305.894736842, 731305.894736842, 812562.1052631577, 893818.3157894735, 975074.5263157892, 1056330.736842105, 1137586.9473684207, 1137586.9473684207, 1137586.9473684207, 1218843.1578947364, 1300099.3684210521, 1381355.5789473678, 1462611.7894736836, 1543867.9999999993, 1543867.9999999993, 1543867.9999999993]}, "12": {"budget": 835514.0, "realise": 1054607.49, "commandes": 762706.6681223, "produit": 1469576.79, "jours_ouvres": 15, "chart_labels": ["01/12", "02/12", "03/12", "04/12", "05/12", "06/12", "07/12", "08/12", "09/12", "10/12", "11/12", "12/12", "13/12", "14/12", "15/12", "16/12", "17/12", "18/12", "19/12", "20/12", "21/12", "22/12", "23/12", "24/12", "25/12", "26/12", "27/12", "28/12", "29/12", "30/12", "31/12"], "chart_ca": [39995.71, 148104.8, 321926.31, 369323.5, 409775.21, 409775.21, 409775.21, 449807.87, 503798.83, 652615.55, 780144.1000000001, 923608.2500000001, 923608.2500000001, 923608.2500000001, 942827.4200000002, 987864.9800000002, 1054204.9500000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002, 1054607.4900000002], "chart_cmd": [16579.47, 60406.3528, 86634.0228, 169436.4833021, 189745.0018438, 189745.0018438, 189745.0018438, 254894.1774594, 281197.5584594, 300283.1280594, 338779.0668094, 370214.1168094, 370214.1168094, 370214.1168094, 423376.14294109994, 477664.30439109995, 523855.1297223, 686673.3603223, 735052.6187223, 735052.6187223, 735052.6187223, 762706.6681223001, 762706.6681223001, 762706.6681223001, 762706.6681223001, 762706.6681223001, 762706.6681223001, 762706.6681223001, 762706.6681223001, 762706.6681223001, 762706.6681223001], "chart_prod": [55467.12, 278798.03, 450858.60000000003, 496141.29000000004, 541619.2000000001, 546416.53, 546416.53, 608404.52, 741112.98, 852952.6599999999, 919974.1499999999, 1077993.6099999999, 1088721.6099999999, 1088721.6099999999, 1171660.21, 1292131.73, 1423125.1099999999, 1447388.7399999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998, 1469576.7899999998], "chart_budget_trend": [55700.933333333334, 111401.86666666667, 167102.8, 222803.73333333334, 278504.6666666667, 278504.6666666667, 278504.6666666667, 334205.60000000003, 389906.5333333334, 445607.46666666673, 501308.4000000001, 557009.3333333334, 557009.3333333334, 557009.3333333334, 612710.2666666667, 668411.2000000001, 724112.1333333334, 779813.0666666668, 835514.0000000001, 835514.0000000001, 835514.0000000001, 835514.0000000001, 835514.0000000001, 835514.0000000001, 835514.0000000001, 835514.0000000001, 835514.0000000001, 835514.0000000001, 835514.0000000001, 835514.0000000001, 835514.0000000001]}, "0": {"budget": 18216126.0, "realise": 17201284.049999997, "commandes": 17999132.947881497, "produit": 17767482.790000003, "jours_ouvres": 234, "chart_labels": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "TOTAL"], "chart_ca": [1686613.5500000003, 1319134.3199999996, 1516096.7900000003, 1427289.0799999998, 1090804.0299999998, 1519824.43, 2029316.75, 667573.78, 1648001.8699999996, 1753841.9800000002, 1488179.98, 1054607.49, 17201284.049999997], "chart_cmd": [1104942.0912509002, 1605240.5986345, 1450300.0392618, 2122136.487931, 1592972.1007440998, 1562204.6459970002, 1881431.8616995998, 786555.2066940999, 1570057.2632188, 1897071.3680524998, 1663514.6162749003, 762706.6681223, 17999132.947881497], "chart_prod": [1707155.2700000003, 1275235.39, 1616553.31, 1448973.35, 1210217.86, 1574081.2, 1843568.0599999996, 666918.78, 1675099.2000000002, 1794023.6300000004, 1486079.9500000002, 1469576.79, 17767482.790000003], "chart_budget_trend": [1728162.0, 1531000.0, 1690064.0, 1770064.0, 1561966.0, 1720064.0, 1818162.0, 530938.0, 1768162.0, 1718162.0, 1543868.0, 835514.0, 18216126.0]}}, "2026": {"1": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 21, "chart_labels": ["01/01", "02/01", "03/01", "04/01", "05/01", "06/01", "07/01", "08/01", "09/01", "10/01", "11/01", "12/01", "13/01", "14/01", "15/01", "16/01", "17/01", "18/01", "19/01", "20/01", "21/01", "22/01", "23/01", "24/01", "25/01", "26/01", "27/01", "28/01", "29/01", "30/01", "31/01"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [0.0, 71428.57142857143, 71428.57142857143, 71428.57142857143, 142857.14285714287, 214285.71428571432, 285714.28571428574, 357142.85714285716, 428571.4285714286, 428571.4285714286, 428571.4285714286, 500000.0, 571428.5714285715, 642857.142857143, 714285.7142857144, 785714.2857142859, 785714.2857142859, 785714.2857142859, 857142.8571428574, 928571.4285714289, 1000000.0000000003, 1071428.5714285718, 1142857.1428571432, 1142857.1428571432, 1142857.1428571432, 1214285.7142857146, 1285714.285714286, 1357142.8571428573, 1428571.4285714286, 1500000.0, 1500000.0]}, "2": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 20, "chart_labels": ["01/02", "02/02", "03/02", "04/02", "05/02", "06/02", "07/02", "08/02", "09/02", "10/02", "11/02", "12/02", "13/02", "14/02", "15/02", "16/02", "17/02", "18/02", "19/02", "20/02", "21/02", "22/02", "23/02", "24/02", "25/02", "26/02", "27/02", "28/02"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [0.0, 75000.0, 150000.0, 225000.0, 300000.0, 375000.0, 375000.0, 375000.0, 450000.0, 525000.0, 600000.0, 675000.0, 750000.0, 750000.0, 750000.0, 825000.0, 900000.0, 975000.0, 1050000.0, 1125000.0, 1125000.0, 1125000.0, 1200000.0, 1275000.0, 1350000.0, 1425000.0, 1500000.0, 1500000.0]}, "3": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 22, "chart_labels": ["01/03", "02/03", "03/03", "04/03", "05/03", "06/03", "07/03", "08/03", "09/03", "10/03", "11/03", "12/03", "13/03", "14/03", "15/03", "16/03", "17/03", "18/03", "19/03", "20/03", "21/03", "22/03", "23/03", "24/03", "25/03", "26/03", "27/03", "28/03", "29/03", "30/03", "31/03"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [0.0, 68181.81818181818, 136363.63636363635, 204545.45454545453, 272727.2727272727, 340909.0909090909, 340909.0909090909, 340909.0909090909, 409090.90909090906, 477272.72727272724, 545454.5454545454, 613636.3636363635, 681818.1818181816, 681818.1818181816, 681818.1818181816, 749999.9999999998, 818181.8181818179, 886363.636363636, 954545.4545454541, 1022727.2727272722, 1022727.2727272722, 1022727.2727272722, 1090909.0909090904, 1159090.9090909085, 1227272.7272727266, 1295454.5454545447, 1363636.3636363628, 1363636.3636363628, 1363636.3636363628, 1431818.181818181, 1499999.999999999]}, "4": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 21, "chart_labels": ["01/04", "02/04", "03/04", "04/04", "05/04", "06/04", "07/04", "08/04", "09/04", "10/04", "11/04", "12/04", "13/04", "14/04", "15/04", "16/04", "17/04", "18/04", "19/04", "20/04", "21/04", "22/04", "23/04", "24/04", "25/04", "26/04", "27/04", "28/04", "29/04", "30/04"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [71428.57142857143, 142857.14285714287, 214285.71428571432, 214285.71428571432, 214285.71428571432, 214285.71428571432, 285714.28571428574, 357142.85714285716, 428571.4285714286, 500000.0, 500000.0, 500000.0, 571428.5714285715, 642857.142857143, 714285.7142857144, 785714.2857142859, 857142.8571428574, 857142.8571428574, 857142.8571428574, 928571.4285714289, 1000000.0000000003, 1071428.5714285718, 1142857.1428571432, 1214285.7142857146, 1214285.7142857146, 1214285.7142857146, 1285714.285714286, 1357142.8571428573, 1428571.4285714286, 1500000.0]}, "5": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 17, "chart_labels": ["01/05", "02/05", "03/05", "04/05", "05/05", "06/05", "07/05", "08/05", "09/05", "10/05", "11/05", "12/05", "13/05", "14/05", "15/05", "16/05", "17/05", "18/05", "19/05", "20/05", "21/05", "22/05", "23/05", "24/05", "25/05", "26/05", "27/05", "28/05", "29/05", "30/05", "31/05"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [0.0, 0.0, 0.0, 88235.29411764706, 176470.58823529413, 264705.8823529412, 352941.17647058825, 352941.17647058825, 352941.17647058825, 352941.17647058825, 441176.4705882353, 529411.7647058824, 617647.0588235295, 617647.0588235295, 705882.3529411766, 705882.3529411766, 705882.3529411766, 794117.6470588237, 882352.9411764708, 970588.2352941179, 1058823.529411765, 1147058.823529412, 1147058.823529412, 1147058.823529412, 1147058.823529412, 1235294.117647059, 1323529.411764706, 1411764.705882353, 1500000.0, 1500000.0, 1500000.0]}, "6": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 22, "chart_labels": ["01/06", "02/06", "03/06", "04/06", "05/06", "06/06", "07/06", "08/06", "09/06", "10/06", "11/06", "12/06", "13/06", "14/06", "15/06", "16/06", "17/06", "18/06", "19/06", "20/06", "21/06", "22/06", "23/06", "24/06", "25/06", "26/06", "27/06", "28/06", "29/06", "30/06"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [68181.81818181818, 136363.63636363635, 204545.45454545453, 272727.2727272727, 340909.0909090909, 340909.0909090909, 340909.0909090909, 409090.90909090906, 477272.72727272724, 545454.5454545454, 613636.3636363635, 681818.1818181816, 681818.1818181816, 681818.1818181816, 749999.9999999998, 818181.8181818179, 886363.636363636, 954545.4545454541, 1022727.2727272722, 1022727.2727272722, 1022727.2727272722, 1090909.0909090904, 1159090.9090909085, 1227272.7272727266, 1295454.5454545447, 1363636.3636363628, 1363636.3636363628, 1363636.3636363628, 1431818.181818181, 1499999.999999999]}, "7": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 22, "chart_labels": ["01/07", "02/07", "03/07", "04/07", "05/07", "06/07", "07/07", "08/07", "09/07", "10/07", "11/07", "12/07", "13/07", "14/07", "15/07", "16/07", "17/07", "18/07", "19/07", "20/07", "21/07", "22/07", "23/07", "24/07", "25/07", "26/07", "27/07", "28/07", "29/07", "30/07", "31/07"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [68181.81818181818, 136363.63636363635, 204545.45454545453, 204545.45454545453, 204545.45454545453, 272727.2727272727, 340909.0909090909, 409090.90909090906, 477272.72727272724, 545454.5454545454, 545454.5454545454, 545454.5454545454, 613636.3636363635, 613636.3636363635, 681818.1818181816, 749999.9999999998, 818181.8181818179, 818181.8181818179, 818181.8181818179, 886363.636363636, 954545.4545454541, 1022727.2727272722, 1090909.0909090904, 1159090.9090909085, 1159090.9090909085, 1159090.9090909085, 1227272.7272727266, 1295454.5454545447, 1363636.3636363628, 1431818.181818181, 1499999.999999999]}, "8": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 21, "chart_labels": ["01/08", "02/08", "03/08", "04/08", "05/08", "06/08", "07/08", "08/08", "09/08", "10/08", "11/08", "12/08", "13/08", "14/08", "15/08", "16/08", "17/08", "18/08", "19/08", "20/08", "21/08", "22/08", "23/08", "24/08", "25/08", "26/08", "27/08", "28/08", "29/08", "30/08", "31/08"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [0.0, 0.0, 71428.57142857143, 142857.14285714287, 214285.71428571432, 285714.28571428574, 357142.85714285716, 357142.85714285716, 357142.85714285716, 428571.4285714286, 500000.0, 571428.5714285715, 642857.142857143, 714285.7142857144, 714285.7142857144, 714285.7142857144, 785714.2857142859, 857142.8571428574, 928571.4285714289, 1000000.0000000003, 1071428.5714285718, 1071428.5714285718, 1071428.5714285718, 1142857.1428571432, 1214285.7142857146, 1285714.285714286, 1357142.8571428573, 1428571.4285714286, 1428571.4285714286, 1428571.4285714286, 1500000.0]}, "9": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 22, "chart_labels": ["01/09", "02/09", "03/09", "04/09", "05/09", "06/09", "07/09", "08/09", "09/09", "10/09", "11/09", "12/09", "13/09", "14/09", "15/09", "16/09", "17/09", "18/09", "19/09", "20/09", "21/09", "22/09", "23/09", "24/09", "25/09", "26/09", "27/09", "28/09", "29/09", "30/09"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [68181.81818181818, 136363.63636363635, 204545.45454545453, 272727.2727272727, 272727.2727272727, 272727.2727272727, 340909.0909090909, 409090.90909090906, 477272.72727272724, 545454.5454545454, 613636.3636363635, 613636.3636363635, 613636.3636363635, 681818.1818181816, 749999.9999999998, 818181.8181818179, 886363.636363636, 954545.4545454541, 954545.4545454541, 954545.4545454541, 1022727.2727272722, 1090909.0909090904, 1159090.9090909085, 1227272.7272727266, 1295454.5454545447, 1295454.5454545447, 1295454.5454545447, 1363636.3636363628, 1431818.181818181, 1499999.999999999]}, "10": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 22, "chart_labels": ["01/10", "02/10", "03/10", "04/10", "05/10", "06/10", "07/10", "08/10", "09/10", "10/10", "11/10", "12/10", "13/10", "14/10", "15/10", "16/10", "17/10", "18/10", "19/10", "20/10", "21/10", "22/10", "23/10", "24/10", "25/10", "26/10", "27/10", "28/10", "29/10", "30/10", "31/10"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [68181.81818181818, 136363.63636363635, 136363.63636363635, 136363.63636363635, 204545.45454545453, 272727.2727272727, 340909.0909090909, 409090.90909090906, 477272.72727272724, 477272.72727272724, 477272.72727272724, 545454.5454545454, 613636.3636363635, 681818.1818181816, 749999.9999999998, 818181.8181818179, 818181.8181818179, 818181.8181818179, 886363.636363636, 954545.4545454541, 1022727.2727272722, 1090909.0909090904, 1159090.9090909085, 1159090.9090909085, 1159090.9090909085, 1227272.7272727266, 1295454.5454545447, 1363636.3636363628, 1431818.181818181, 1499999.999999999, 1499999.999999999]}, "11": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 20, "chart_labels": ["01/11", "02/11", "03/11", "04/11", "05/11", "06/11", "07/11", "08/11", "09/11", "10/11", "11/11", "12/11", "13/11", "14/11", "15/11", "16/11", "17/11", "18/11", "19/11", "20/11", "21/11", "22/11", "23/11", "24/11", "25/11", "26/11", "27/11", "28/11", "29/11", "30/11"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [0.0, 75000.0, 150000.0, 225000.0, 300000.0, 375000.0, 375000.0, 375000.0, 450000.0, 525000.0, 525000.0, 600000.0, 675000.0, 675000.0, 675000.0, 750000.0, 825000.0, 900000.0, 975000.0, 1050000.0, 1050000.0, 1050000.0, 1125000.0, 1200000.0, 1275000.0, 1350000.0, 1425000.0, 1425000.0, 1425000.0, 1500000.0]}, "12": {"budget": 1500000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 22, "chart_labels": ["01/12", "02/12", "03/12", "04/12", "05/12", "06/12", "07/12", "08/12", "09/12", "10/12", "11/12", "12/12", "13/12", "14/12", "15/12", "16/12", "17/12", "18/12", "19/12", "20/12", "21/12", "22/12", "23/12", "24/12", "25/12", "26/12", "27/12", "28/12", "29/12", "30/12", "31/12"], "chart_ca": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_cmd": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_prod": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "chart_budget_trend": [68181.81818181818, 136363.63636363635, 204545.45454545453, 272727.2727272727, 272727.2727272727, 272727.2727272727, 340909.0909090909, 409090.90909090906, 477272.72727272724, 545454.5454545454, 613636.3636363635, 613636.3636363635, 613636.3636363635, 681818.1818181816, 749999.9999999998, 818181.8181818179, 886363.636363636, 954545.4545454541, 954545.4545454541, 954545.4545454541, 1022727.2727272722, 1090909.0909090904, 1159090.9090909085, 1227272.7272727266, 1227272.7272727266, 1227272.7272727266, 1227272.7272727266, 1295454.5454545447, 1363636.3636363628, 1431818.181818181, 1499999.999999999]}, "0": {"budget": 18000000.0, "realise": 0.0, "commandes": 0.0, "produit": 0.0, "jours_ouvres": 252, "chart_labels": ["01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "TOTAL"], "chart_ca": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "chart_cmd": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "chart_prod": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "chart_budget_trend": [1500000.0, 1500000.0, 1500000.0, 1500000.0, 1500000.0, 1500000.0, 1500000.0, 1500000.0, 1500000.0, 1500000.0, 1500000.0, 1500000.0, 18000000.0]}}};
            
            // ETAT
            let currentYear = null;
            let currentMonth = null;
            let myChart = null;
            let compChart = null;

            // Noms de mois
            const MONTH_NAMES = {
                "0": "Ann√©e Enti√®re",
                "1": "Janvier", "2": "F√©vrier", "3": "Mars", "4": "Avril", "5": "Mai", "6": "Juin",
                "7": "Juillet", "8": "Ao√ªt", "9": "Septembre", "10": "Octobre", "11": "Novembre", "12": "D√©cembre"
            };

            function initHome() {
                const container = document.getElementById('year-buttons');
                container.innerHTML = '';
                // Trier les ann√©es croissant
                const years = Object.keys(DB_DATA).sort((a,b) => a-b);
                years.forEach(y => {
                    const btn = document.createElement('div');
                    btn.className = 'year-btn';
                    btn.innerText = y;
                    btn.onclick = () => selectYear(y);
                    container.appendChild(btn);
                });
            }

            function selectYear(year) {
                currentYear = year;
                document.getElementById('view-home').classList.remove('active');
                document.getElementById('view-dashboard').classList.add('active');
                document.getElementById('year-display').innerText = year;
                
                // Peupler le selecteur de mois
                const monthSelect = document.getElementById('month-selector');
                monthSelect.innerHTML = '';
                
                // Sort months numerically, "0" will naturally come first
                const months = Object.keys(DB_DATA[year]).sort((a,b) => parseInt(a)-parseInt(b));
                months.forEach(m => {
                    const opt = document.createElement('option');
                    opt.value = m;
                    opt.innerText = MONTH_NAMES[m] || m;
                    monthSelect.appendChild(opt);
                });
                
                // Selectionner le premier par d√©faut (qui sera "0" -> Ann√©e Enti√®re si pr√©sent, ou "1" Janvier)
                if (months.length > 0) {
                    selectMonth(months[0]);
                }
            }

            function goHome() {
                document.getElementById('view-dashboard').classList.remove('active');
                document.getElementById('view-comparison').classList.remove('active');
                document.getElementById('view-home').classList.add('active');
            }

            // --- COMPARISON LOGIC ---
            function goToComparison() {
                document.getElementById('view-home').classList.remove('active');
                document.getElementById('view-comparison').classList.add('active');
                initComparison();
            }

            function initComparison() {
                const years = Object.keys(DB_DATA).sort((a,b) => a-b);
                const container = document.getElementById('comp-toggles');
                container.innerHTML = '';
                
                years.forEach(y => {
                    const label = document.createElement('label');
                    label.style = "display: flex; align-items: center; gap: 5px; cursor: pointer; user-select: none;";
                    
                    const cb = document.createElement('input');
                    cb.type = 'checkbox';
                    cb.value = y;
                    cb.checked = true; // par d√©faut tout coch√©
                    cb.onchange = updateCompChart;
                    
                    label.appendChild(cb);
                    label.appendChild(document.createTextNode(y));
                    container.appendChild(label);
                });
                
                updateCompChart();
            }

            function updateCompChart() {
                // R√©cup√©rer les ann√©es coch√©es
                const checkboxes = document.querySelectorAll('#comp-toggles input[type="checkbox"]');
                const selectedYears = Array.from(checkboxes).filter(cb => cb.checked).map(cb => cb.value);
                
                const ctx = document.getElementById('compChart').getContext('2d');
                if (compChart) compChart.destroy();
                
                // Pr√©parer datasets pour mois (Jan-Dec) et totaux annuels
                const colors = ['#3498db', '#e74c3c', '#9b59b6', '#2ecc71', '#f1c40f', '#34495e'];
                const datasets = [];
                
                selectedYears.forEach((y, idx) => {
                    if (DB_DATA[y] && DB_DATA[y]["0"]) {
                        const dataFull = DB_DATA[y]["0"].chart_ca; // CA R√©alis√© = Exp√©ditions
                        const dataMonths = dataFull.slice(0, 12); // Jan-Dec
                        const dataTotal = dataFull[12]; // Total annuel
                        
                        // Dataset pour les mois (12 valeurs + null pour Total)
                        const monthData = [...dataMonths, null];
                        // Dataset pour le total (12 nulls + valeur totale)
                        const totalData = [...Array(12).fill(null), dataTotal];
                        
                        const color = colors[idx % colors.length];
                        
                        // Barres mensuelles (axe Y gauche)
                        datasets.push({
                            label: "Chiffre d'affaires",
                            data: monthData,
                            backgroundColor: color,
                            borderColor: color,
                            borderWidth: 1,
                            yAxisID: 'y',
                            stack: 'stack' + idx
                        });
                        
                        // Barre totale (axe Y droit)
                        datasets.push({
                            label: y + ' (Total)',
                            data: totalData,
                            backgroundColor: color,
                            borderColor: color,
                            borderWidth: 1,
                            yAxisID: 'y1',
                            stack: 'total' + idx
                        });
                    }
                });
                
                const labels = ["Jan", "F√©v", "Mar", "Avr", "Mai", "Juin", "Juil", "Ao√ªt", "Sep", "Oct", "Nov", "D√©c", "TOTAL"];
                
                compChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: { mode: 'index', intersect: false },
                        plugins: {
                            legend: { 
                                position: 'top',
                                labels: {
                                    filter: function(item, chart) {
                                        // Ne montrer que "Chiffre d'affaires" dans la l√©gende
                                        return item.text === "Chiffre d'affaires";
                                    }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    title: function(context) {
                                        const label = context[0].label;
                                        return label;
                                    },
                                    label: function(context) {
                                        // Extraire l'ann√©e du label du dataset
                                        let yearLabel = context.dataset.label;
                                        if (yearLabel.includes('(Total)')) {
                                            yearLabel = yearLabel.replace(' (Total)', '');
                                        } else {
                                            yearLabel = selectedYears[Math.floor(context.datasetIndex / 2)];
                                        }
                                        
                                        let label = yearLabel + ': ';
                                        if (context.parsed.y !== null) {
                                            label += new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR', maximumFractionDigits: 0 }).format(context.parsed.y);
                                        }
                                        return label;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                position: 'left',
                                title: { display: true, text: 'Mensuel' },
                                grid: { color: '#f0f0f0' }
                            },
                            y1: {
                                beginAtZero: true,
                                position: 'right',
                                title: { display: true, text: 'Total Annuel' },
                                grid: { drawOnChartArea: false }
                            }
                        }
                    }
                });
            }

            function selectMonth(m) {
                currentMonth = m;
                document.getElementById('month-selector').value = m;
                updateDashboard();
            }

            function updateDashboard() {
                if (!currentYear || !currentMonth) return;
                
                const data = DB_DATA[currentYear][currentMonth];
                
                // 1. UPDATE KPIs
                document.getElementById('kpi-days').innerText = data.jours_ouvres;
                document.getElementById('kpi-budget').innerText = formatMoney(data.budget);
                
                const percent = data.budget > 0 ? (data.realise / data.budget * 100) : 0;
                const kpiPercent = document.getElementById('kpi-percent');
                kpiPercent.innerText = percent.toFixed(1) + '%';
                
                // Couleur dynamique KPI
                const kpiCard = document.getElementById('kpi-card-perf');
                const isGood = percent >= 100;
                kpiCard.style.borderColor = isGood ? 'var(--success)' : 'var(--danger)';
                kpiPercent.className = 'kpi-value ' + (isGood ? 'positive' : 'negative');

                // 2. UPDATE TABLE
                document.getElementById('val-ca').innerText = formatMoney(data.realise);
                document.getElementById('val-cmd').innerText = formatMoney(data.commandes);
                document.getElementById('val-prod').innerText = formatMoney(data.produit);
                
                const diff = data.realise - data.budget;
                const elDiff = document.getElementById('val-diff');
                elDiff.innerText = (diff > 0 ? '+' : '') + formatMoney(diff);
                elDiff.className = 'metric-val ' + (diff >= 0 ? 'positive' : 'negative');

                // 3. UPDATE CHART
                updateChart(data);
            }

            function formatMoney(amount) {
                return new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR' }).format(amount);
            }

            function updateChart(data) {
                const ctx = document.getElementById('mainChart').getContext('2d');
                
                if (myChart) {
                    myChart.destroy();
                }

                // D√©tection Type de Graph
                // Si "0" (Ann√©e enti√®re) => Bar chart (Histogramme)
                // Sinon => Line chart (Courbe cumul√©e)
                const isYearView = (currentMonth === "0");
                const chartType = isYearView ? 'bar' : 'line';
                const tensionVal = isYearView ? 0 : 0.4;
                const fillVal = isYearView ? false : true;
                
                // Adaptation visuelle Budget
                const budgetType = isYearView ? 'bar' : 'line'; // On peut mixer
                const budgetLabel = isYearView ? 'Budget Mensuel' : 'Budget Cible (Trend)';
                const budgetBorderDash = isYearView ? [] : [2, 2];
                // Afficher le budget en ligne rouge m√™me sur l'histo pour bien voir ?
                // Ou en barre rouge ? Le prompt dit "Histogramme mensuel", donc tout barres c'est plus s√ªr.
                
                // Configuration des Axes (Scales)
                const scalesConfig = {
                    y: {
                        beginAtZero: true,
                        position: 'left',
                        grid: { color: '#f0f0f0' },
                        title: { display: isYearView, text: 'Mensuel' }
                    },
                    x: { grid: { display: false } }
                };

                // Si vue annuelle : Axe Y1 √† droite pour le Total
                if (isYearView) {
                    scalesConfig.y1 = {
                        beginAtZero: true,
                        position: 'right',
                        grid: { drawOnChartArea: false }, // avoid grid clutter
                        title: { display: true, text: 'Cumul Annuel (Total)' }
                    };
                }

                // Construction des Datasets
                let finalDatasets = [];

                if (isYearView) {
                    // Fonctions pour s√©parer Mois (0-11) et Total (12)
                    // On suppose data.chart_labels a 13 entr√©es (01..12, TOTAL)
                    const splitData = (arr) => {
                        const monthly = arr.slice(0, 12);
                        const dMonth = [...monthly, null];
                        const dTotal = [...Array(12).fill(null), arr[12]];
                        return { dMonth, dTotal };
                    };

                    const b = splitData(data.chart_budget_trend);
                    const r = splitData(data.chart_ca);
                    const c = splitData(data.chart_cmd);
                    const p = splitData(data.chart_prod);
                    
                    finalDatasets = [
                        // PAIRES : On met le m√™me label pour que la l√©gende soit propre (ou concat√©n√©)
                        // BUDGET
                        {
                            label: 'Budget',
                            data: b.dMonth,
                            borderColor: '#e74c3c',
                            backgroundColor: '#e74c3c',
                            type: 'line', 
                            borderWidth: 2,
                            pointRadius: 3,
                            tension: 0.1,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Budget (Total)',
                            data: b.dTotal,
                            borderColor: '#e74c3c',
                            backgroundColor: '#e74c3c',
                            type: 'bar', // Total en barre aussi ou point ? Barre c'est mieux si tout est barre
                            borderWidth: 2,
                            yAxisID: 'y1'
                        },
                        // CA
                        {
                            label: 'CA R√©alis√©',
                            data: r.dMonth,
                            backgroundColor: '#3498db',
                            borderColor: '#3498db',
                            borderWidth: 1,
                            yAxisID: 'y'
                        },
                        {
                            label: 'CA (Total)',
                            data: r.dTotal,
                            backgroundColor: '#3498db', // Plus sombre ?
                            borderColor: '#3498db',
                            borderWidth: 1,
                            yAxisID: 'y1'
                        },
                        // CMD
                        {
                            label: 'Prise de Cde',
                            data: c.dMonth,
                            backgroundColor: '#9b59b6',
                            borderColor: '#9b59b6',
                            borderWidth: 1,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Cde (Total)',
                            data: c.dTotal,
                            backgroundColor: '#9b59b6',
                            borderColor: '#9b59b6',
                            borderWidth: 1,
                            yAxisID: 'y1'
                        },
                        // PROD
                        {
                            label: 'Produit',
                            data: p.dMonth,
                            backgroundColor: '#2ecc71',
                            borderColor: '#2ecc71',
                            borderWidth: 1,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Prod (Total)',
                            data: p.dTotal,
                            backgroundColor: '#2ecc71',
                            borderColor: '#2ecc71',
                            borderWidth: 1,
                            yAxisID: 'y1'
                        }
                    ];

                } else {
                    // Vue Mensuelle Normale
                    finalDatasets = [
                        {
                            label: budgetLabel,
                            data: data.chart_budget_trend,
                            borderColor: '#e74c3c',
                            backgroundColor: 'transparent',
                            type: 'line',
                            borderWidth: 2,
                            borderDash: budgetBorderDash,
                            pointRadius: 0,
                            tension: 0.1,
                            yAxisID: 'y'
                        },
                        {
                            label: 'CA R√©alis√©',
                            data: data.chart_ca,
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            borderWidth: 3,
                            fill: fillVal,
                            tension: tensionVal,
                             yAxisID: 'y'
                        },
                         {
                            label: 'Prise de Cde',
                            data: data.chart_cmd,
                            borderColor: '#9b59b6',
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            tension: tensionVal,
                             yAxisID: 'y'
                        },
                         {
                            label: 'Produit',
                            data: data.chart_prod,
                            borderColor: '#2ecc71',
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            tension: tensionVal,
                             yAxisID: 'y'
                        }
                    ];
                }
                
                myChart = new Chart(ctx, {
                    type: chartType,
                    data: {
                        labels: data.chart_labels, // [01..12, TOTAL]
                        datasets: finalDatasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: { mode: 'index', intersect: false },
                        plugins: {
                            legend: { position: 'bottom' },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) label += ': ';
                                        if (context.parsed.y !== null) {
                                            label += new Intl.NumberFormat('fr-FR', { style: 'currency', currency: 'EUR', maximumFractionDigits: 0 }).format(context.parsed.y);
                                        }
                                        return label;
                                    }
                                }
                            }
                        },
                        scales: scalesConfig
                    }
                });
            }

            // Start
            initHome();
        </script>
    </body>
    </html>
    